import pandas as pd
import numpy as np

# 数据透视表，三列一维变二维
时间	代码	市值
20181228	601872.SH	3774870
20181229	601872.SH	3774870
20181230	601872.SH	3774870
20181231	601872.SH	3774870
20190101	601872.SH	3774870
20190102	601872.SH	3774870
20190103	601872.SH	3733950


data = pd.read_csv("data.csv",encoding="gb18030",engine="python")
data.head()

data_tran = pd.pivot_table(data,index="时间",columns="代码",values=["市值"],fill_value=0)

时间\代码	000683.SZ	000709.SZ	000718.SZ
20190307	4183521	4158297	4481495.8
20190308	3907381	3868722	4135046
20190309	3907381	3868722	4135046
20190310	3907381	3868722	4135046
20190311	4142100	3972969	4202100.8
20190312	4128293	4077216	4302683
20190313	4086872	4007718	4246804
20190314	3948802	3949803	4146221.8
20190315	3990223	3996135	4190925
20190316	3990223	3996135	4190925
20190317	3990223	3996135	4190925
